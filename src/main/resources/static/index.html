<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fabrick API</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Fabrick API</h1>

        <div>
            <label for="accountId">Account ID:</label>
            <input type="text" id="accountId" placeholder="Inserisci l'Account ID">
        </div>

        <div>
            <h2>Balance</h2>
            <button onclick="getBalance()">Get Balance</button>
            <p id="balance-result"></p>
        </div>

        <div>
            <h2>Transactions</h2>
            <label for="fromDate">From Date:</label>
            <input type="date" id="fromDate">
            <label for="toDate">To Date:</label>
            <input type="date" id="toDate">
            <button onclick="getTransactions()">Get Transactions</button>
            <p id="transactions-result"></p>
        </div>

        <div>
            <h2>Money Transfer</h2>
            <label for="amount">Amount:</label>
            <input type="number" id="amount">
            <label for="recipient">Recipient:</label>
            <input type="text" id="recipient">
            <button onclick="makeMoneyTransfer()">Make Transfer</button>
            <p id="transfer-result"></p>
        </div>
    </div>

    <script>
        function getAccountId() {
            return document.getElementById('accountId').value;
        }

        function getBalance() {
            const accountId = getAccountId();
            if (!accountId) {
                alert("Per favore, inserisci l'Account ID!");
                return;
            }

            fetch(`/api/fabrick/accounts/${accountId}/balance`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('balance-result').textContent = JSON.stringify(data);
                })
                .catch(error => {
                    console.error('Error fetching balance:', error);
                });
        }

        function getTransactions() {
            const accountId = getAccountId();
            const fromDate = document.getElementById('fromDate').value;
            const toDate = document.getElementById('toDate').value;

            if (!accountId) {
                alert("Per favore, inserisci l'Account ID!");
                return;
            }

            fetch(`/api/fabrick/accounts/${accountId}/transactions?fromAccountingDate=${fromDate}&toAccountingDate=${toDate}`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('transactions-result').textContent = JSON.stringify(data);
                })
                .catch(error => {
                    console.error('Error fetching transactions:', error);
                });
        }

        function makeMoneyTransfer() {
            const accountId = getAccountId();
            const amount = document.getElementById('amount').value;
            const recipient = document.getElementById('recipient').value;

            if (!accountId) {
                alert("Per favore, inserisci l'Account ID!");
                return;
            }

            const requestData = {
                amount: amount,
                recipient: recipient
            };

            fetch(`/api/fabrick/accounts/${accountId}/payments/money-transfers`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestData)
            })
                .then(response => response.json())
                .then(data => {
                    document.getElementById('transfer-result').textContent = JSON.stringify(data);
                })
                .catch(error => {
                    console.error('Error making transfer:', error);
                });
        }
    </script>
</body>
</html>
